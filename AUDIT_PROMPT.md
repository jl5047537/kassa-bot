# Промт для аудита кода Kassa Bot

## 1. ОБЩИЕ ТРЕБОВАНИЯ
- Провести полный аудит кода на соответствие TECHNICAL_SPECIFICATION.md
- Проверить соответствие зависимостей VERSIONS.md
- Использовать DEPENDENCIES_PROMPT.md как руководство по проверке зависимостей
- Все команды для PowerShell должны быть в правильном формате
- Учитывать особенности работы в PowerShell при проверке

## 2. ОБЛАСТИ ПРОВЕРКИ

### 2.1. Структура проекта
- Соответствие структуры директорий ТЗ
- Наличие всех необходимых файлов
- Корректность именования файлов и директорий
- Соответствие структуры базы данных миграциям
- Корректность путей для PowerShell

### 2.2. Telegram Бот
- Проверка всех команд (/start, /pay, /set_phone и т.д.)
- Корректность обработки ошибок
- Безопасность обработки пользовательских данных
- Работа с конфигурационными файлами
- Корректность запуска в PowerShell

### 2.3. FastAPI Приложение
- Корректность эндпоинтов
- Валидация данных
- Обработка ошибок
- Безопасность API
- Корректность запуска в PowerShell

### 2.4. Интеграция с TON
- Корректность работы с TON API
- Безопасность хранения API ключей
- Обработка транзакций
- Нормализация адресов
- Корректность работы в PowerShell

### 2.5. База данных
- Соответствие моделей миграциям
- Корректность связей между таблицами
- Оптимизация запросов
- Безопасность работы с данными
- Корректность миграций в PowerShell

### 2.6. Безопасность
- Проверка уязвимостей в зависимостях
- Безопасность хранения конфиденциальных данных
- Защита от SQL-инъекций
- Валидация входных данных
- Особенности безопасности PowerShell

## 3. ПРОЦЕСС АУДИТА

### 3.1. Подготовка
- Создать копию проекта для тестирования
- Подготовить тестовое окружение в PowerShell
- Настроить логирование аудита
- Проверить корректность путей в PowerShell

### 3.2. Проверка
- Пошаговое выполнение всех функций в PowerShell
- Тестирование граничных случаев
- Проверка обработки ошибок
- Анализ производительности
- Проверка совместимости с PowerShell

### 3.3. Документирование
- Фиксация всех найденных проблем
- Приоритизация проблем:
  * Критические (блокирующие работу)
  * Важные (влияющие на функциональность)
  * Незначительные (косметические)
- Подробное описание каждой проблемы
- Предложение решений
- Учет особенностей PowerShell

## 4. ОТЧЕТНОСТЬ

### 4.1. Формат отчета
- Список всех проверенных компонентов
- Детальное описание каждой проблемы:
  * Описание проблемы
  * Приоритет
  * Возможные последствия
  * Предлагаемое решение
  * Оценка сложности исправления
  * Особенности для PowerShell

### 4.2. Рекомендации
- Приоритетный порядок исправлений
- Предложения по оптимизации
- Рекомендации по безопасности
- Предложения по улучшению архитектуры
- Рекомендации по работе в PowerShell

## 5. ПРОЦЕСС ИСПРАВЛЕНИЯ
- Не вносить изменения без явного одобрения
- Дожидаться решения по каждой проблеме
- Предоставлять варианты решений
- Документировать все изменения
- Учитывать особенности PowerShell

## 6. ПРОВЕРКА ИСПРАВЛЕНИЙ
- Проверка каждого исправления
- Тестирование после изменений
- Обновление документации
- Проверка обратной совместимости
- Проверка работы в PowerShell 